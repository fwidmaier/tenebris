\documentclass[a4paper, 11pt]{article}

\usepackage{mlmodern}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\usepackage[margin=2cm]{geometry}
\usepackage{listings}

\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape\bfseries}

\usepackage{qrcode}
\usepackage{collectbox}


\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}

\newcommand{\tenebris}{\texttt{tenebris}}
\newcommand{\R}{\mathbb R}
\newcommand{\Duals}[1]{#1[\varepsilon]/\left\langle\varepsilon^2\right\rangle}

\makeatletter
\newcommand{\boxedcode}{%
    \collectbox{%
        \setlength{\fboxsep}{5pt}%
        \fbox{\BOXCONTENT}%
    }%
}
\makeatother


\renewcommand{\lstlistingname}{Code}

\definecolor{codebg}{RGB}{230,230,230}
\lstset {
    breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
    breaklines=true,                 % sets automatic line breaking
    captionpos=b,                    % sets the caption-position to bottom
    tabsize=4,
    %showstringspaces=false,
    numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
    numbersep=2pt,                   % how far the line-numbers are from the code
    numberstyle=\tiny, % the style that is used for the line-numbers
    %upquote=true,
    backgroundcolor = \color{codebg},
    basicstyle=\small\ttfamily, % basic font setting
    emph={int,char,double,float,unsigned,void,bool},
    %emphstyle={\color{blue}},
    escapechar=\&,
    columns=fixed
}

\title{\bfseries\sffamily Some notes on \tenebris{}}
\author{Felix Widmaier}
\date{\today}

\begin{document}
    \maketitle
    \begin{abstract}
        A small and simple \texttt{Python} library that supports automatic differentiation using
        dual numbers and solving some simple equations.
    \end{abstract}

    \section*{Getting started}
\addcontentsline{toc}{section}{Getting started}
The code of \tenebris{} was originally published on
\begin{center}
    \qrcode{https://github.com/fwidmaier/tenebris}\\
    \vspace*{0.5cm}
    \href{https://github.com/fwidmaier/tenebris}{\url{https://github.com/fwidmaier/tenebris}}
\end{center}
To install the library, simply use
\begin{center}
    \boxedcode{\texttt{pip install dist/tenebris-1.0-py2.py3-none-any.whl}}
\end{center}
To build the wheel file of the library, use
\begin{center}
    \boxedcode{\texttt{python setup.py bdist\_wheel --universal}}
\end{center}
\paragraph{Dependencies.} The required packages to work with \tenebris{} are listed in \texttt{requirements.txt}.
    \textcolor{red}{Currently, there are no dependencies. Only standard libraries are used.}
\newpage
\section{Dual numbers}
    Define $\mathcal{D} = \Duals{\mathbb R}$ to be the polynomial ring with one variable $\varepsilon$
    modulo the ideal generated by $\varepsilon^2$. So any element in $\mathcal{D}$ is of the form
    \begin{align*}
        d = a + b\varepsilon
    \end{align*}
    for some $a,b\in\mathbb R$. We call $a$ the \textit{real part} of $d$ and $b$ the \textit{dual part} of $d$.
    Let us consider some analytic function $f\colon\mathbb R\to\mathbb R$.
    Then by the Taylor expansion of $f$ we have for some $x + b\varepsilon\in\mathcal{D}$
    \begin{align*}
        f(x + b\varepsilon) &= f(x) + f'(x)b\varepsilon + \frac{f''(x)}{2}b^2\varepsilon^2
        + \frac{f'''(x)}{6}b^3\varepsilon^3 + \cdots\\
        &= f(x) + f'(x)b\varepsilon.
    \end{align*}
    Hence $f(x + \varepsilon) = f(x) + f'(x)\varepsilon$.
    \texttt{Et voil√†!}
    This is basically all we need for automatic differentiation using dual numbers!
    We only need to know the dual part of $f(x + \varepsilon)$ and we obtain $f'(x)$.
    \paragraph{Example.} Let us go through a little toy example in order to
    get some better grasp on dual numbers.
    For instance, let $f\colon x\mapsto x^n$ for some $n\in\mathbb N$.
    Then
    \begin{align*}
        f(x + \varepsilon) &= (x + \varepsilon)^n = \sum^n_{k=0}\binom{n}{k}x^{n-k}\varepsilon^{k}\\
        &= x^n + nx^{n-1}\varepsilon + \binom{n}{2}x^{n-2}\varepsilon^2 + \cdots = x^n + nx^{n-1}\varepsilon.
    \end{align*}
    Just as expected.\\

    Basic computations show
    \begin{align*}
    (a + b\varepsilon) + (c& + d\varepsilon) = a + c + (b + d)\varepsilon,\qquad(a + b\varepsilon)(c + d\varepsilon) = ac + (ad + bc)\varepsilon\\
        &\text{and}\qquad(a + b\varepsilon)(c + d\varepsilon)^{-1} = \frac{a}{c} + \frac{bc - ad}{c^2}\varepsilon\qquad\text{where $c\neq 0$}.
    \end{align*}
    This arithmetic of dual numbers is basically encoded in the class \texttt{Dual}.
    The differentiating operator is implemented as \texttt{d}.
    It evaluates the given function on $x + \varepsilon$ (or rather \texttt{Dual(x,1)}) and returns
    the dual part of the result.
    We can now give a small example:
    \paragraph{Example.} A priori we can now differentiate any polynomial!
    For example, consider the function $f\colon x\mapsto x^2-x-1$.
    We expect the derivative to vanish at $\frac{1}{2}$.
    Using \tenebris{}, we can write the following little piece of code:
    \begin{lstlisting}
from tenebris import d

f = lambda x: x * x - x - 1
df = d(f)  # the derivative of f. This is literally al it takes!
print(df(0.5))
    \end{lstlisting}
    And the output of this is \texttt{0.0} -- just as we expected.
\end{document}